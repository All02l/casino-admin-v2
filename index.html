<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { color: white; background: #1c1c1c; font-family: sans-serif; padding: 20px; text-align: center; }
        .card { background: #2c2c2c; padding: 15px; border-radius: 10px; margin-bottom: 15px; }
        h2 { color: #0088cc; }
        .grid { display: grid; grid-template-columns: repeat(11, 1fr); gap: 4px; margin: 10px 0; }
        .dot { height: 12px; border-radius: 2px; background: #444; }
        .filled { background: #00ff00; box-shadow: 0 0 5px #00ff00; }
        .empty { background: #ff4444; }
        button { 
            background: #0088cc; color: white; border: none; 
            padding: 12px; width: 100%; border-radius: 8px; 
            font-weight: bold; cursor: pointer; margin-top: 10px;
        }
        button:active { background: #0077b3; }
        p { font-size: 12px; color: #aaa; }
    </style>
</head>
<body>
    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ö–∞–∑–∏–Ω–æ üé∞</h2>

    <div class="card">
        <h3>üìä –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–æ–≤ (1-33)</h3>
        <div id="server-grid" class="grid"></div>
        <p id="stats-text">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
    </div>

    <div class="card">
        <button onclick="changeRate()">üí∞ –ò–∑–º–µ–Ω–∏—Ç—å –∫—É—Ä—Å</button>
        <button onclick="manageServers()">üñ• –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –†–∏—Å—É–µ–º —Å–µ—Ç–∫—É —Å–µ—Ä–≤–µ—Ä–æ–≤
        const urlParams = new URLSearchParams(window.location.search);
        const stats = urlParams.get('stats') || "0".repeat(33);
        const grid = document.getElementById('server-grid');
        let filledCount = 0;

        for (let i = 0; i < 33; i++) {
            let dot = document.createElement('div');
            dot.className = 'dot ' + (stats[i] === '1' ? 'filled' : 'empty');
            if (stats[i] === '1') filledCount++;
            grid.appendChild(dot);
        }
        document.getElementById('stats-text').innerText = `–ó–∞–ø–æ–ª–Ω–µ–Ω–æ: ${filledCount} –∏–∑ 33`;

        function changeRate() {
            let newRate = prompt("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –∫—É—Ä—Å:");
            if (newRate) tg.sendData("set_rate:" + newRate.trim());
        }

        async function manageServers() {
            let serverNum = prompt("–®–∞–≥ 1/3: –ù–æ–º–µ—Ä —Å–µ—Ä–≤–µ—Ä–∞ (1-33):");
            if (!serverNum || serverNum < 1 || serverNum > 33) return;

            let accNum = prompt("–®–∞–≥ 2/3: –ù–æ–º–µ—Ä —Å—á—ë—Ç–∞ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ " + serverNum + ":");
            if (!accNum) return;

            let accName = prompt("–®–∞–≥ 3/3: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—á—ë—Ç–∞ (–Ω–∏–∫):");
            if (!accName) return;

            tg.sendData(`set_server:${serverNum.trim()}|${accNum.trim()}|${accName.trim()}`);
        }
    </script>
</body>
</html>
